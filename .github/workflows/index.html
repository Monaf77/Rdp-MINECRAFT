<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RDP Session Manager</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 20px; }
        .card { max-width: 600px; margin: 0 auto; }
        .status { margin-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center my-4">RDP Session Manager</h1>
        
        <div class="card">
            <div class="card-header">
                <h3>Start RDP Session</h3>
            </div>
            <div class="card-body">
                <form id="rdpForm">
                    <div class="mb-3">
                        <label class="form-label">Session Duration (minutes)</label>
                        <select class="form-select" id="duration">
                            <option value="30">30 minutes</option>
                            <option value="60" selected>1 hour</option>
                            <option value="120">2 hours</option>
                            <option value="240">4 hours</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">RDP Password</label>
                        <input type="password" class="form-control" id="password" 
                               placeholder="Enter RDP password" required>
                    </div>
                    
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary">Start RDP Session</button>
                    </div>
                </form>
                
                <div id="status" class="mt-3 alert" style="display: none;"></div>
                
                <div id="connectionInfo" class="mt-4" style="display: none;">
                    <h4>Connection Information</h4>
                    <div class="mb-2">Status: <span id="statusText" class="badge bg-success">Ready</span></div>
                    <div class="mb-2">IP: <code id="ipAddress">Loading...</code></div>
                    <div class="mb-2">Username: <code>RDPUser</code></div>
                    <div class="mb-2">Password: <code id="rdpPassword"></code></div>
                    <div class="mb-2">Port: <code>3389</code></div>
                    <div class="mb-2">Expires: <span id="expiryTime">-</span></div>
                    
                    <div class="mt-3">
                        <a id="rdpLink" href="#" class="btn btn-success" target="_blank">
                            <i class="bi bi-display"></i> Open RDP Connection
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('rdpForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const duration = document.getElementById('duration').value;
            const password = document.getElementById('password').value;
            const statusDiv = document.getElementById('status');
            const connectionInfo = document.getElementById('connectionInfo');
            
            // Show loading
            statusDiv.style.display = 'block';
            statusDiv.className = 'alert alert-info';
            statusDiv.textContent = 'Starting RDP session...';
            
            try {
                // In a real implementation, you would call your GitHub Actions API here
                // This is a simulation of what would happen
                
                // Simulate API call delay
                await new Promise(resolve => setTimeout(resolve, 3000));
                
                // Show success
                statusDiv.className = 'alert alert-success';
                statusDiv.textContent = 'RDP session started successfully!';
                
                // In a real implementation, you would get these from the API response
                const ipAddress = 'YOUR_SERVER_IP'; // Replace with actual IP
                const rdpFile = `full address:s:${ipAddress}:3389
username:s:RDPUser
password:s:${password}`;
                
                // Update UI
                document.getElementById('ipAddress').textContent = ipAddress;
                document.getElementById('rdpPassword').textContent = password;
                
                // Set expiry time
                const expiry = new Date();
                expiry.setMinutes(expiry.getMinutes() + parseInt(duration));
                document.getElementById('expiryTime').textContent = expiry.toLocaleString();
                
                // Create RDP file download
                const blob = new Blob([rdpFile], { type: 'application/rdp' });
                const url = URL.createObjectURL(blob);
                const rdpLink = document.getElementById('rdpLink');
                rdpLink.href = url;
                rdpLink.download = 'connection.rdp';
                
                // Show connection info
                connectionInfo.style.display = 'block';
                
            } catch (error) {
                statusDiv.className = 'alert alert-danger';
                statusDiv.textContent = `Error: ${error.message}`;
            }
        });
    </script>
</body>
</html>
